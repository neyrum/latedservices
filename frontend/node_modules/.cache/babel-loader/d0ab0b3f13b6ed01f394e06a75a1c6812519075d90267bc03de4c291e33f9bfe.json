{"ast":null,"code":"import { createElementVNode as _createElementVNode, openBlock as _openBlock, createElementBlock as _createElementBlock, createCommentVNode as _createCommentVNode, toDisplayString as _toDisplayString, renderList as _renderList, Fragment as _Fragment, normalizeClass as _normalizeClass, createTextVNode as _createTextVNode } from \"vue\";\nconst _hoisted_1 = {\n  class: \"admin-requests\"\n};\nconst _hoisted_2 = {\n  key: 0\n};\nconst _hoisted_3 = {\n  key: 1,\n  class: \"error\"\n};\nconst _hoisted_4 = {\n  key: 2,\n  class: \"table table-striped\"\n};\nconst _hoisted_5 = [\"onClick\"];\nconst _hoisted_6 = [\"onClick\"];\nconst _hoisted_7 = [\"onClick\"];\nconst _hoisted_8 = {\n  key: 3\n};\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  return _openBlock(), _createElementBlock(\"div\", _hoisted_1, [_cache[1] || (_cache[1] = _createElementVNode(\"h3\", {\n    class: \"dashboard-title\"\n  }, \"Solicitudes Pendientes\", -1 /* HOISTED */)), $data.isLoading ? (_openBlock(), _createElementBlock(\"p\", _hoisted_2, \"Cargando solicitudes...\")) : _createCommentVNode(\"v-if\", true), $data.errorMessage ? (_openBlock(), _createElementBlock(\"p\", _hoisted_3, _toDisplayString($data.errorMessage), 1 /* TEXT */)) : _createCommentVNode(\"v-if\", true), $data.requests.length > 0 ? (_openBlock(), _createElementBlock(\"table\", _hoisted_4, [_cache[0] || (_cache[0] = _createElementVNode(\"thead\", null, [_createElementVNode(\"tr\", null, [_createElementVNode(\"th\", null, \"#\"), _createElementVNode(\"th\", null, \"Cliente\"), _createElementVNode(\"th\", null, \"Servicio\"), _createElementVNode(\"th\", null, \"Estado\"), _createElementVNode(\"th\", null, \"Fecha Preferida\"), _createElementVNode(\"th\", null, \"Acciones\")])], -1 /* HOISTED */)), _createElementVNode(\"tbody\", null, [(_openBlock(true), _createElementBlock(_Fragment, null, _renderList($data.requests, request => {\n    return _openBlock(), _createElementBlock(\"tr\", {\n      key: request.id\n    }, [_createElementVNode(\"td\", null, _toDisplayString(request.id), 1 /* TEXT */), _createElementVNode(\"td\", null, _toDisplayString(request.client?.name || 'Sin asignar'), 1 /* TEXT */), _createElementVNode(\"td\", null, _toDisplayString(request.service?.name), 1 /* TEXT */), _createElementVNode(\"td\", {\n      class: _normalizeClass($options.statusClass(request.status))\n    }, [_createElementVNode(\"i\", {\n      class: _normalizeClass($options.statusIcon(request.status))\n    }, null, 2 /* CLASS */), _createTextVNode(\" \" + _toDisplayString(request.status), 1 /* TEXT */)], 2 /* CLASS */), _createElementVNode(\"td\", null, _toDisplayString(new Date(request.preferredDate).toLocaleDateString()), 1 /* TEXT */), _createElementVNode(\"td\", null, [_createElementVNode(\"button\", {\n      class: \"btn btn-success btn-sm\",\n      onClick: $event => $options.updateRequestStatus(request.id, 'aprobado')\n    }, \" Aprobar \", 8 /* PROPS */, _hoisted_5), _createElementVNode(\"button\", {\n      class: \"btn btn-danger btn-sm\",\n      onClick: $event => $options.updateRequestStatus(request.id, 'rechazado')\n    }, \" Rechazar \", 8 /* PROPS */, _hoisted_6), _createElementVNode(\"button\", {\n      class: \"btn btn-info btn-sm\",\n      onClick: $event => $options.goToDetails(request.id)\n    }, \" Detalles \", 8 /* PROPS */, _hoisted_7)])]);\n  }), 128 /* KEYED_FRAGMENT */))])])) : _createCommentVNode(\"v-if\", true), !$data.isLoading && $data.requests.length === 0 ? (_openBlock(), _createElementBlock(\"p\", _hoisted_8, \" No hay solicitudes pendientes. \")) : _createCommentVNode(\"v-if\", true)]);\n}","map":{"version":3,"names":["class","key","_createElementBlock","_hoisted_1","_createElementVNode","$data","isLoading","_hoisted_2","_createCommentVNode","errorMessage","_hoisted_3","_toDisplayString","requests","length","_hoisted_4","_Fragment","_renderList","request","id","client","name","service","_normalizeClass","$options","statusClass","status","statusIcon","_createTextVNode","Date","preferredDate","toLocaleDateString","onClick","$event","updateRequestStatus","_hoisted_5","_hoisted_6","goToDetails","_hoisted_7","_hoisted_8"],"sources":["/home/lated/LatedServices/frontend/src/views/admin/AdminRequests.vue"],"sourcesContent":["<template>\n  <div class=\"admin-requests\">\n    <h3 class=\"dashboard-title\">Solicitudes Pendientes</h3>\n\n    <p v-if=\"isLoading\">Cargando solicitudes...</p>\n    <p v-if=\"errorMessage\" class=\"error\">{{ errorMessage }}</p>\n\n    <table v-if=\"requests.length > 0\" class=\"table table-striped\">\n      <thead>\n        <tr>\n          <th>#</th>\n          <th>Cliente</th>\n          <th>Servicio</th>\n          <th>Estado</th>\n          <th>Fecha Preferida</th>\n          <th>Acciones</th>\n        </tr>\n      </thead>\n      <tbody>\n        <tr v-for=\"request in requests\" :key=\"request.id\">\n          <td>{{ request.id }}</td>\n          <td>{{ request.client?.name || 'Sin asignar' }}</td>\n          <td>{{ request.service?.name }}</td>\n          <td :class=\"statusClass(request.status)\">\n            <i :class=\"statusIcon(request.status)\"></i> {{ request.status }}\n          </td>\n          <td>{{ new Date(request.preferredDate).toLocaleDateString() }}</td>\n          <td>\n            <button class=\"btn btn-success btn-sm\"\n              @click=\"updateRequestStatus(request.id, 'aprobado')\">\n              Aprobar\n            </button>\n            <button class=\"btn btn-danger btn-sm\"\n              @click=\"updateRequestStatus(request.id, 'rechazado')\">\n              Rechazar\n            </button>\n            <button class=\"btn btn-info btn-sm\"\n              @click=\"goToDetails(request.id)\">\n              Detalles\n            </button>\n          </td>\n        </tr>\n      </tbody>\n    </table>\n\n    <p v-if=\"!isLoading && requests.length === 0\">\n      No hay solicitudes pendientes.\n    </p>\n  </div>\n</template>\n\n<script>\nimport axios from \"@/plugins/axios\";\n\nexport default {\n  name: \"AdminRequests\",\n  data() {\n    return {\n      requests: [],\n      isLoading: false,\n      errorMessage: \"\"\n    };\n  },\n  created() {\n    this.fetchRequests();\n  },\n  methods: {\n    async fetchRequests() {\n      this.isLoading = true;\n      try {\n        const response = await axios.get(\"/requests\", {\n          headers: { Authorization: \"Bearer \" + this.$store.getters[\"auth/token\"] }\n        });\n        this.requests = response.data.data || response.data;\n      } catch (error) {\n        this.errorMessage = error.response?.data?.message || \"Error al cargar las solicitudes.\";\n      } finally {\n        this.isLoading = false;\n      }\n    },\n    async updateRequestStatus(requestId, newStatus) {\n      try {\n        await axios.put(`/requests/${requestId}/status`, { status: newStatus }, {\n          headers: { Authorization: \"Bearer \" + this.$store.getters[\"auth/token\"] }\n        });\n        this.fetchRequests();\n      } catch (error) {\n        this.errorMessage =\n          error.response?.data?.message || \"Error al actualizar solicitud.\";\n        console.error(\"Error al actualizar solicitud:\", error);\n      }\n    },\n    goToDetails(requestId) {\n      console.log(\"Navegando a detalles de la solicitud ID:\", requestId);\n      this.$router.push({ name: \"request-details\", params: { id: requestId } });\n    },\n    statusClass(status) {\n      const statusMap = {\n        pendiente: \"bg-warning text-dark\",\n        aprobado: \"bg-info text-white\",\n        rechazado: \"bg-danger text-white\",\n        en_progreso: \"bg-primary text-white\",\n        completado: \"bg-success text-white\",\n        cancelado: \"bg-secondary text-white\"\n      };\n      return statusMap[status] || \"bg-light\";\n    },\n    statusIcon(status) {\n      const iconMap = {\n        pendiente: \"fas fa-hourglass-start text-warning\",\n        aprobado: \"fas fa-check-circle text-info\",\n        rechazado: \"fas fa-times-circle text-danger\",\n        en_progreso: \"fas fa-spinner text-primary\",\n        completado: \"fas fa-check text-success\",\n        cancelado: \"fas fa-ban text-secondary\"\n      };\n      return iconMap[status] || \"fas fa-question-circle text-muted\";\n    }\n  }\n};\n</script>\n\n<style scoped>\n.dashboard-title {\n  font-size: 22px;\n  font-weight: bold;\n  margin-bottom: 15px;\n}\n\n.table {\n  width: 100%;\n  margin-top: 20px;\n}\n\n.btn-sm {\n  margin-right: 5px;\n}\n\n.error {\n  color: red;\n  font-weight: bold;\n}\n\n.bg-warning { background-color: #ffc107; }\n.bg-info { background-color: #17a2b8; }\n.bg-danger { background-color: #dc3545; }\n.bg-primary { background-color: #007bff; }\n.bg-success { background-color: #28a745; }\n.bg-secondary { background-color: #6c757d; }\n.bg-light { background-color: #f8f9fa; }\n\n.text-dark { color: black; }\n.text-white { color: white; }\n</style>\n"],"mappings":";;EACOA,KAAK,EAAC;AAAgB;;EAD7BC,GAAA;AAAA;;EAAAA,GAAA;EAK2BD,KAAK,EAAC;;;EALjCC,GAAA;EAOsCD,KAAK,EAAC;;mBAP5C;mBAAA;mBAAA;;EAAAC,GAAA;AAAA;;uBACEC,mBAAA,CA+CM,OA/CNC,UA+CM,G,0BA9CJC,mBAAA,CAAuD;IAAnDJ,KAAK,EAAC;EAAiB,GAAC,wBAAsB,sBAEzCK,KAAA,CAAAC,SAAS,I,cAAlBJ,mBAAA,CAA+C,KAJnDK,UAAA,EAIwB,yBAAuB,KAJ/CC,mBAAA,gBAKaH,KAAA,CAAAI,YAAY,I,cAArBP,mBAAA,CAA2D,KAA3DQ,UAA2D,EAAAC,gBAAA,CAAnBN,KAAA,CAAAI,YAAY,oBALxDD,mBAAA,gBAOiBH,KAAA,CAAAO,QAAQ,CAACC,MAAM,Q,cAA5BX,mBAAA,CAoCQ,SApCRY,UAoCQ,G,0BAnCNV,mBAAA,CASQ,gBARNA,mBAAA,CAOK,aANHA,mBAAA,CAAU,YAAN,GAAC,GACLA,mBAAA,CAAgB,YAAZ,SAAO,GACXA,mBAAA,CAAiB,YAAb,UAAQ,GACZA,mBAAA,CAAe,YAAX,QAAM,GACVA,mBAAA,CAAwB,YAApB,iBAAe,GACnBA,mBAAA,CAAiB,YAAb,UAAQ,E,wBAGhBA,mBAAA,CAwBQ,iB,kBAvBNF,mBAAA,CAsBKa,SAAA,QAzCbC,WAAA,CAmB8BX,KAAA,CAAAO,QAAQ,EAAnBK,OAAO;yBAAlBf,mBAAA,CAsBK;MAtB4BD,GAAG,EAAEgB,OAAO,CAACC;QAC5Cd,mBAAA,CAAyB,YAAAO,gBAAA,CAAlBM,OAAO,CAACC,EAAE,kBACjBd,mBAAA,CAAoD,YAAAO,gBAAA,CAA7CM,OAAO,CAACE,MAAM,EAAEC,IAAI,mCAC3BhB,mBAAA,CAAoC,YAAAO,gBAAA,CAA7BM,OAAO,CAACI,OAAO,EAAED,IAAI,kBAC5BhB,mBAAA,CAEK;MAFAJ,KAAK,EAvBpBsB,eAAA,CAuBsBC,QAAA,CAAAC,WAAW,CAACP,OAAO,CAACQ,MAAM;QACpCrB,mBAAA,CAA2C;MAAvCJ,KAAK,EAxBrBsB,eAAA,CAwBuBC,QAAA,CAAAG,UAAU,CAACT,OAAO,CAACQ,MAAM;6BAxBhDE,gBAAA,CAwBuD,GAAC,GAAAhB,gBAAA,CAAGM,OAAO,CAACQ,MAAM,iB,kBAE/DrB,mBAAA,CAAmE,YAAAO,gBAAA,KAAxDiB,IAAI,CAACX,OAAO,CAACY,aAAa,EAAEC,kBAAkB,oBACzD1B,mBAAA,CAaK,aAZHA,mBAAA,CAGS;MAHDJ,KAAK,EAAC,wBAAwB;MACnC+B,OAAK,EAAAC,MAAA,IAAET,QAAA,CAAAU,mBAAmB,CAAChB,OAAO,CAACC,EAAE;OAAe,WAEvD,iBA/BZgB,UAAA,GAgCY9B,mBAAA,CAGS;MAHDJ,KAAK,EAAC,uBAAuB;MAClC+B,OAAK,EAAAC,MAAA,IAAET,QAAA,CAAAU,mBAAmB,CAAChB,OAAO,CAACC,EAAE;OAAgB,YAExD,iBAnCZiB,UAAA,GAoCY/B,mBAAA,CAGS;MAHDJ,KAAK,EAAC,qBAAqB;MAChC+B,OAAK,EAAAC,MAAA,IAAET,QAAA,CAAAa,WAAW,CAACnB,OAAO,CAACC,EAAE;OAAG,YAEnC,iBAvCZmB,UAAA,E;wCAAA7B,mBAAA,gB,CA6CcH,KAAA,CAAAC,SAAS,IAAID,KAAA,CAAAO,QAAQ,CAACC,MAAM,U,cAAtCX,mBAAA,CAEI,KA/CRoC,UAAA,EA6CkD,kCAE9C,KA/CJ9B,mBAAA,e","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}