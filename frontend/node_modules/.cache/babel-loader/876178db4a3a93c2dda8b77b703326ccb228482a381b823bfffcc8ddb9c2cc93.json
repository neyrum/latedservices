{"ast":null,"code":"import { createCommentVNode as _createCommentVNode, createElementVNode as _createElementVNode, toDisplayString as _toDisplayString, renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, resolveComponent as _resolveComponent, createBlock as _createBlock, createVNode as _createVNode } from \"vue\";\nconst _hoisted_1 = {\n  class: \"dashboard-home\"\n};\nconst _hoisted_2 = {\n  class: \"dashboard-subtitle\"\n};\nconst _hoisted_3 = {\n  class: \"cards\"\n};\nconst _hoisted_4 = {\n  class: \"cards\"\n};\nconst _hoisted_5 = {\n  class: \"dashboard-subtitle\"\n};\nconst _hoisted_6 = {\n  class: \"cards\"\n};\nconst _hoisted_7 = {\n  key: 4,\n  class: \"stats-container\"\n};\nconst _hoisted_8 = {\n  key: 5,\n  class: \"stats-container\"\n};\nconst _hoisted_9 = {\n  key: 6,\n  class: \"error\"\n};\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  const _component_DashboardCard = _resolveComponent(\"DashboardCard\");\n  const _component_DashboardChart = _resolveComponent(\"DashboardChart\");\n  const _component_DashboardLineChart = _resolveComponent(\"DashboardLineChart\");\n  return _openBlock(), _createElementBlock(\"div\", _hoisted_1, [_createCommentVNode(\" Vista para Super Administradores \"), $options.isSuperAdmin ? (_openBlock(), _createElementBlock(_Fragment, {\n    key: 0\n  }, [_cache[0] || (_cache[0] = _createElementVNode(\"h2\", {\n    class: \"dashboard-title\"\n  }, \"Super Admin Dashboard\", -1 /* HOISTED */)), _createElementVNode(\"p\", _hoisted_2, \" Bienvenido, \" + _toDisplayString($options.userData.name) + \". Aquí puedes administrar todo el sistema. \", 1 /* TEXT */), _createElementVNode(\"div\", _hoisted_3, [(_openBlock(true), _createElementBlock(_Fragment, null, _renderList($options.superAdminCards, card => {\n    return _openBlock(), _createBlock(_component_DashboardCard, {\n      key: card.title,\n      title: card.title,\n      value: card.value\n    }, null, 8 /* PROPS */, [\"title\", \"value\"]);\n  }), 128 /* KEYED_FRAGMENT */))])], 64 /* STABLE_FRAGMENT */)) : $options.isAdmin ? (_openBlock(), _createElementBlock(_Fragment, {\n    key: 1\n  }, [_createCommentVNode(\" Vista para Administradores \"), _cache[1] || (_cache[1] = _createElementVNode(\"h2\", {\n    class: \"dashboard-title\"\n  }, \"Admin Dashboard\", -1 /* HOISTED */)), _createElementVNode(\"div\", _hoisted_4, [(_openBlock(true), _createElementBlock(_Fragment, null, _renderList($options.adminCards, card => {\n    return _openBlock(), _createBlock(_component_DashboardCard, {\n      key: card.title,\n      title: card.title,\n      value: card.value\n    }, null, 8 /* PROPS */, [\"title\", \"value\"]);\n  }), 128 /* KEYED_FRAGMENT */))])], 64 /* STABLE_FRAGMENT */)) : $options.isUser ? (_openBlock(), _createElementBlock(_Fragment, {\n    key: 2\n  }, [_createCommentVNode(\" Vista para Usuarios Regulares \"), _cache[2] || (_cache[2] = _createElementVNode(\"h2\", {\n    class: \"dashboard-title\"\n  }, \"User Dashboard\", -1 /* HOISTED */)), _createElementVNode(\"p\", _hoisted_5, \" Bienvenido, \" + _toDisplayString($options.userData.name) + \". Aquí tienes tu información personalizada. \", 1 /* TEXT */), _createElementVNode(\"div\", _hoisted_6, [_createCommentVNode(\" Aquí se muestra la cantidad de servicios activos (simulada o real) \"), _createVNode(_component_DashboardCard, {\n    title: \"Servicios Activos\",\n    value: $data.userServicesCount || 0\n  }, null, 8 /* PROPS */, [\"value\"]), _createCommentVNode(\" Se utiliza la propiedad computada para contar dinámicamente las solicitudes pendientes \"), _createVNode(_component_DashboardCard, {\n    title: \"Solicitudes Pendientes\",\n    value: $options.userPendingCountComputed\n  }, null, 8 /* PROPS */, [\"value\"])])], 64 /* STABLE_FRAGMENT */)) : (_openBlock(), _createElementBlock(_Fragment, {\n    key: 3\n  }, [_createCommentVNode(\" Vista genérica para roles sin contenido específico \"), _cache[3] || (_cache[3] = _createElementVNode(\"h2\", {\n    class: \"dashboard-title\"\n  }, \"Dashboard\", -1 /* HOISTED */)), _cache[4] || (_cache[4] = _createElementVNode(\"p\", {\n    class: \"dashboard-subtitle\"\n  }, \" Tu rol no tiene contenido específico. \", -1 /* HOISTED */))], 64 /* STABLE_FRAGMENT */)), _createCommentVNode(\" Sección de gráficos de los datos existentes (para Admin/SuperAdmin) \"), ($options.isSuperAdmin || $options.isAdmin) && $data.requestsChartData.labels.length ? (_openBlock(), _createElementBlock(\"div\", _hoisted_7, [_createVNode(_component_DashboardChart, {\n    title: \"Solicitudes Totales\",\n    chartData: $data.requestsChartData\n  }, null, 8 /* PROPS */, [\"chartData\"]), _createVNode(_component_DashboardChart, {\n    title: \"Servicios Activos\",\n    chartData: $data.servicesChartData\n  }, null, 8 /* PROPS */, [\"chartData\"])])) : _createCommentVNode(\"v-if\", true), _createCommentVNode(\" Sección de gráfico para la evolución del total de usuarios (para Admin/SuperAdmin) \"), ($options.isSuperAdmin || $options.isAdmin) && $data.totalUsersChartData.labels.length ? (_openBlock(), _createElementBlock(\"div\", _hoisted_8, [_createVNode(_component_DashboardLineChart, {\n    title: \"Evolución Total de Usuarios\",\n    chartData: $data.totalUsersChartData\n  }, null, 8 /* PROPS */, [\"chartData\"])])) : _createCommentVNode(\"v-if\", true), $data.errorMessage ? (_openBlock(), _createElementBlock(\"div\", _hoisted_9, _toDisplayString($data.errorMessage), 1 /* TEXT */)) : _createCommentVNode(\"v-if\", true)]);\n}","map":{"version":3,"names":["class","key","_createElementBlock","_hoisted_1","_createCommentVNode","$options","isSuperAdmin","_Fragment","_createElementVNode","_hoisted_2","_toDisplayString","userData","name","_hoisted_3","_renderList","superAdminCards","card","_createBlock","_component_DashboardCard","title","value","isAdmin","_hoisted_4","adminCards","isUser","_hoisted_5","_hoisted_6","_createVNode","$data","userServicesCount","userPendingCountComputed","requestsChartData","labels","length","_hoisted_7","_component_DashboardChart","chartData","servicesChartData","totalUsersChartData","_hoisted_8","_component_DashboardLineChart","errorMessage","_hoisted_9"],"sources":["/home/lated/LatedServices/frontend/src/views/admin/DashboardHome.vue"],"sourcesContent":["<template>\n  <div class=\"dashboard-home\">\n    <!-- Vista para Super Administradores -->\n    <template v-if=\"isSuperAdmin\">\n      <h2 class=\"dashboard-title\">Super Admin Dashboard</h2>\n      <p class=\"dashboard-subtitle\">\n        Bienvenido, {{ userData.name }}. Aquí puedes administrar todo el sistema.\n      </p>\n      <div class=\"cards\">\n        <DashboardCard\n          v-for=\"card in superAdminCards\"\n          :key=\"card.title\"\n          :title=\"card.title\"\n          :value=\"card.value\"\n        />\n      </div>\n    </template>\n\n    <!-- Vista para Administradores -->\n    <template v-else-if=\"isAdmin\">\n      <h2 class=\"dashboard-title\">Admin Dashboard</h2>\n      <div class=\"cards\">\n        <DashboardCard\n          v-for=\"card in adminCards\"\n          :key=\"card.title\"\n          :title=\"card.title\"\n          :value=\"card.value\"\n        />\n      </div>\n    </template>\n\n    <!-- Vista para Usuarios Regulares -->\n    <template v-else-if=\"isUser\">\n      <h2 class=\"dashboard-title\">User Dashboard</h2>\n      <p class=\"dashboard-subtitle\">\n        Bienvenido, {{ userData.name }}. Aquí tienes tu información personalizada.\n      </p>\n      <div class=\"cards\">\n        <!-- Aquí se muestra la cantidad de servicios activos (simulada o real) -->\n        <DashboardCard title=\"Servicios Activos\" :value=\"userServicesCount || 0\" />\n        <!-- Se utiliza la propiedad computada para contar dinámicamente las solicitudes pendientes -->\n        <DashboardCard title=\"Solicitudes Pendientes\" :value=\"userPendingCountComputed\" />\n      </div>\n    </template>\n\n    <!-- Vista genérica para roles sin contenido específico -->\n    <template v-else>\n      <h2 class=\"dashboard-title\">Dashboard</h2>\n      <p class=\"dashboard-subtitle\">\n        Tu rol no tiene contenido específico.\n      </p>\n    </template>\n\n    <!-- Sección de gráficos de los datos existentes (para Admin/SuperAdmin) -->\n    <div\n      class=\"stats-container\"\n      v-if=\"(isSuperAdmin || isAdmin) && requestsChartData.labels.length\"\n    >\n      <DashboardChart title=\"Solicitudes Totales\" :chartData=\"requestsChartData\" />\n      <DashboardChart title=\"Servicios Activos\" :chartData=\"servicesChartData\" />\n    </div>\n\n    <!-- Sección de gráfico para la evolución del total de usuarios (para Admin/SuperAdmin) -->\n    <div\n      class=\"stats-container\"\n      v-if=\"(isSuperAdmin || isAdmin) && totalUsersChartData.labels.length\"\n    >\n      <DashboardLineChart title=\"Evolución Total de Usuarios\" :chartData=\"totalUsersChartData\" />\n    </div>\n\n    <div v-if=\"errorMessage\" class=\"error\">{{ errorMessage }}</div>\n  </div>\n</template>\n\n<script>\nimport axios from \"@/plugins/axios\";\nimport DashboardCard from \"@/components/DashboardCard.vue\";\nimport DashboardChart from \"@/components/DashboardChart.vue\";\nimport DashboardLineChart from \"@/components/DashboardLineChart.vue\";\nimport RequestHistory from \"@/views/client/RequestHistory.vue\"; // se importa, pero no se usa aquí\nimport { mapState } from \"vuex\";\n\nexport default {\n  name: \"DashboardHome\",\n  components: { DashboardCard, DashboardChart, DashboardLineChart, RequestHistory },\n  data() {\n    return {\n      summary: {\n        totalRequests: 0,\n        activeServices: 0,\n        pendingRequests: 0,\n        totalUsers: 0,\n        systemLogs: 0,\n      },\n      userServicesCount: 0,\n      // Eliminamos el valor estático de userPendingCount; usaremos la propiedad computada.\n      errorMessage: \"\",\n      // Datos para gráficas:\n      requestsChartData: {\n        labels: [],\n        datasets: [],\n      },\n      servicesChartData: {\n        labels: [],\n        datasets: [],\n      },\n      totalUsersChartData: {\n        labels: [],\n        datasets: [],\n      },\n    };\n  },\n  computed: {\n    userData() {\n      // Obtiene los datos del usuario desde Vuex\n      return this.$store.getters[\"auth/userData\"] || {};\n    },\n    userRole() {\n      return this.userData.role || \"\";\n    },\n    isSuperAdmin() {\n      return this.userRole === \"superadmin\";\n    },\n    isAdmin() {\n      return this.userRole === \"admin\";\n    },\n    isUser() {\n      return this.userRole === \"client\";\n    },\n    adminCards() {\n      return [\n        { title: \"Total de Solicitudes\", value: this.summary.totalRequests || 0 },\n        { title: \"Servicios Activos\", value: this.summary.activeServices || 0 },\n        { title: \"Solicitudes Pendientes\", value: this.summary.pendingRequests || 0 },\n      ];\n    },\n    superAdminCards() {\n      return [\n        { title: \"Total de Usuarios\", value: this.summary.totalUsers || 0 },\n        { title: \"Total de Solicitudes\", value: this.summary.totalRequests || 0 },\n        { title: \"Servicios Activos\", value: this.summary.activeServices || 0 },\n        { title: \"Solicitudes Pendientes\", value: this.summary.pendingRequests || 0 },\n        { title: \"Registros del Sistema\", value: this.summary.systemLogs || 0 },\n      ];\n    },\n    // Mapear el estado 'requests' del módulo Vuex 'requests'\n    ...mapState(\"requests\", {\n      requests: (state) => state.requests,\n    }),\n    // Propiedad computada para contar las solicitudes pendientes filtrando por status \"pending\"\n    userPendingCountComputed() {\n      if (!this.requests) return 0;\n      return this.requests.filter(req => req.status === \"pending\").length;\n    },\n  },\n  created() {\n    this.fetchSummary();\n    this.fetchUserStats();\n    this.fetchActiveServices();\n    // Despacha la acción para obtener la información real de solicitudes del usuario\n    this.$store.dispatch(\"requests/fetchRequests\");\n  },\n  methods: {\n    async fetchSummary() {\n      try {\n        const response = await axios.get(\"/admin/summary\");\n        this.summary = response.data;\n\n        // Actualizar datos del gráfico de solicitudes\n        this.requestsChartData = {\n          labels: [\n            \"Enero\", \"Febrero\", \"Marzo\", \"Abril\", \"Mayo\",\n            \"Junio\", \"Julio\", \"Agosto\", \"Septiembre\", \"Octubre\", \"Noviembre\", \"Diciembre\"\n          ],\n          datasets: [\n            {\n              label: \"Solicitudes Totales\",\n              backgroundColor: \"#345896\",\n              data: [\n                this.summary.totalRequests,\n                25,\n                40,\n                35,\n                50,\n              ],\n            },\n          ],\n        };\n\n        // Actualizar datos del gráfico de servicios\n        this.servicesChartData = {\n          labels: [\n            \"Enero\", \"Febrero\", \"Marzo\", \"Abril\", \"Mayo\",\n            \"Junio\", \"Julio\", \"Agosto\", \"Septiembre\", \"Octubre\", \"Noviembre\", \"Diciembre\"\n          ],\n          datasets: [\n            {\n              label: \"Servicios Activos\",\n              backgroundColor: \"#28a745\",\n              data: [\n                this.summary.activeServices,\n                20,\n                30,\n                35,\n                45,\n              ],\n            },\n          ],\n        };\n\n        // Datos simulados para gráfico de evolución de usuarios (reemplaza según tu API)\n        this.totalUsersChartData = {\n          labels: [\n            \"Enero\", \"Febrero\", \"Marzo\", \"Abril\", \"Mayo\",\n            \"Junio\", \"Julio\", \"Agosto\", \"Septiembre\", \"Octubre\", \"Noviembre\", \"Diciembre\"\n          ],\n          datasets: [\n            {\n              label: \"Total de Usuarios\",\n              borderColor: \"#FF6384\",\n              backgroundColor: \"rgba(255, 99, 132, 0.2)\",\n              data: [100, 150, 200, 250, 500, this.summary.totalUsers || 300],\n              fill: true,\n            },\n          ],\n        };\n      } catch (error) {\n        this.errorMessage =\n          error.response?.data?.message || \"Error al cargar datos de resumen.\";\n      }\n    },\n    async fetchUserStats() {\n      try {\n        // Para los servicios activos, se simula un valor o lo obtienes desde otra API\n        // this.userServicesCount = 3;\n        // Ya no se asigna userPendingCount de forma estática, pues se calcula con la propiedad computada.\n      } catch (error) {\n        console.error(\"Error al cargar datos del usuario\", error);\n      }\n    },\n    async fetchActiveServices() {\n    try {\n      const response = await axios.get(\"/services/active\", {\n        headers: {\n          Authorization: `Bearer ${this.$store.getters[\"auth/token\"]}`,\n        },\n      });\n      // Se actualiza la propiedad 'userServicesCount' con la cantidad de servicios activos\n      this.userServicesCount = response.data.data.length;\n      console.log(\"Servicios activos obtenidos:\", response.data.data);\n    } catch (error) {\n      console.error(\"Error al obtener servicios activos:\", error);\n      this.errorMessage =\n        error.response?.data?.message || \"Error al cargar servicios activos.\";\n    }\n    },\n  },\n};\n</script>\n\n<style scoped>\n.dashboard-home {\n  padding: 20px;\n  text-align: center;\n}\n\n.dashboard-title {\n  font-size: 26px;\n  font-weight: bold;\n  color: #345896;\n  margin-bottom: 20px;\n  text-transform: uppercase;\n}\n\n.dashboard-subtitle {\n  font-size: 16px;\n  color: #555;\n  margin-bottom: 20px;\n}\n\n.cards {\n  display: flex;\n  flex-wrap: wrap;\n  gap: 20px;\n  justify-content: center;\n}\n\n.stats-container {\n  display: flex;\n  flex-wrap: wrap;\n  gap: 20px;\n  justify-content: center;\n  margin-top: 20px;\n}\n\n.error {\n  margin-top: 20px;\n  color: #d9534f;\n  font-size: 14px;\n}\n</style>\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}